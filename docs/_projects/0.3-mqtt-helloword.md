---
title: "MQTT HelloWorld"
permalink: /docs/projects/mqtt-helloworld
excerpt: "Connect DevKit to a public free MQTT broker, send messages to the server and print it out if it is successful"
header:
  image: /assets/images/projects-mqtt-helloworld.jpg
  teaser: /assets/images/projects-mqtt-helloworld-th.jpg
---

In this project, you will learn how to use the MQTT Client library to send message to a MQTT broker.
The MQTT client library we used is part of the [Eclipse Paho](http://www.eclipse.org/paho/) project, which provides APIs for using MQTT over multiple transports.

{% include toc icon="columns" %}

## What you need

* Finish the [Getting Started Guide]({{"/docs/getting-started/" | absolute_url }})

## Steps to use the MQTT example

### Step 1. Launch VS Code
Launch **VS Code** first and connect your DevKit to your computer. VS Code will automatically detect your DevKit and pop up the introduction page:

![mqtt-example-vscode]({{"/assets/images/mqtt-vscode-connect.jpg" | absolute_url}})

### Step 2. Open Arduino Examples Folder
Switch to **'Arduino Examples'** tab, navigate to `Examples for MXCHIP AZ3166 > MQTT` and click on `MQTTClient`.

![mqtt-example-vscode]({{"/assets/images/mqtt-examples-folder.jpg" | absolute_url}})

If you closed the Arduino Examples pane, to reload it, use `Ctrl+Shift+P` to invoke command palette and type `Arduino` then find and select `Arduino: Examples`.

### Step 4. Verify and upload MQTT Arduino example to device

Before uploading the MQTT example code to your device. You need to configure your Wi-Fi setting in *MQTTClient.ino* file, providing Wi-Fi SSID and password in the Arduino sketch code:

![mqtt-set-wifi]({{"/assets/images/mqtt-set-wifi.jpg" | absolute_url}})

After saving your Wi-Fi configuration, then use the **Quick Open** (`Ctrl+P`) to run command **task device-upload**. It will take a while if this is a fist-time upload.

### Step 5. Verify output from Serial Monitor

1. Open Serial Monitor
   * Use Serial Monitor of VS Code Arduino Extension
     In Arduino, you can simply click the power plug icon in the status bar to open Serial Monitor:

     ![mqtt-vscode-serial-monitor]({{"/assets/images/mqtt-vscode-serial-monitor.jpg" | absolute_url}})

   * Use other Serial Monitor software instead
     you can also use other serial monitor you like to monitor the serial output, such as [Putty](http://www.putty.org/), [USR-TCP232-Test](http://www.usriot.com/usr-tcp-test-v1-3/), etc.

2. Set correct COM port number and baud rate (115200) of your serial connection.

   * Set **COM port**
     
     In Arduino, click the port number in the status bar and select the COM port youtr device is connected in the input box.

     ![mqtt-serial-set-com-port]({{"/assets/images/mqtt-serial-set-com-port.jpg" | absolute_url}})

   * Set **baud rate**

     In Arduino, click the baud rate number in the status bar and input 115200,

     ![mqtt-serial-set-baud-rate]({{"/assets/images/mqtt-serial-set-baud-rate.jpg" | absolute_url}})

3. Verify serial output

   The serial monitor show the progress of the MQTT HelloWorld example. In the setup stage, the device connected to the Wi-Fi with give Wi-Fi SSID and password. In each loop, two messages will be sent to the MQTT broker ("iot.eclipse.org") via QoS0 and QoS1.

   ![mqtt-serial-output]({{"/assets/images/mqtt-serial-output.jpg" | absolute_url}})


## See Also

* [Connect DevKits to Azure IoT Hub ]({{"/docs/getting-started/" | absolute_url }})
* [Shake Shake to get twitter message] ({{"/docs/projects/shake-shake/" | absolute_url }})
